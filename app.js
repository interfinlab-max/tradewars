/* === –ü–ê–°–•–ê–õ–ö–ê R6TR0 DRAGON === 
–ü–ö: Ctrl + Shift + R, –∑–∞—Ç–µ–º –Ω–∞–±—Ä–∞—Ç—å "6tr0" 
–ú–æ–±–∏–ª—å–Ω—ã–µ: 5 –±—ã—Å—Ç—Ä—ã—Ö —Ç–∞–ø–æ–≤ –ø–æ –ª–æ–≥–æ, –∑–∞—Ç–µ–º –¥–æ–ª–≥–∏–π —Ç–∞–ø 2 —Å–µ–∫
ASCII Dragon:
______________
|            /
| R6TR0     / 
/        /\  /\ 
|___________/ 
(   . .)  <===(
 \ U /        |
  ___\___/______|
|               |
|   LEGENDARY   |
|   DEVELOPER   |
|_______________|
*/

// –í–µ—Ä—Å–∏—è –∏–≥—Ä—ã
const GAME_VERSION = "v2.1.0";

// –ò–≥—Ä–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
const gameData = {
    baseState: {
        gdpIdx: 100.0,
        expIdx: 100.0,
        impIdx: 100.0,
        cpi: 2.0,
        unemployment: 5.0
    },
    stepsNormal: 15, // –°—Ç–∞—Ç–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
    stepsAdvanced: 15, // –†–∞–Ω–¥–æ–º–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
    totalScenarios: 100,
    countries: {
        US: {
            name: "–°–®–ê",
            flag: "üá∫üá∏",
            difficulty: "–õ–µ–≥–∫–∞—è",
            bonus: 3,
            specialties: ["—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", "—Ñ–∏–Ω–∞–Ω—Å—ã", "—ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞", "–∞–≥—Ä–æ–ø—Ä–æ–º"],
            base_modifiers: {
                gdpIdx: 10,
                expIdx: 0,
                impIdx: 10,
                cpi: -0.3,
                unemployment: -0.5
            }
        },
        CN: {
            name: "–ö–∏—Ç–∞–π",
            flag: "üá®üá≥",
            difficulty: "–ü—Ä–æ—Å—Ç–∞—è",
            bonus: 5,
            specialties: ["–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ", "—ç–∫—Å–ø–æ—Ä—Ç", "—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", "–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞"],
            base_modifiers: {
                gdpIdx: 8,
                expIdx: 15,
                impIdx: 5,
                cpi: 0.2,
                unemployment: -1.5
            }
        },
        DE: {
            name: "–ì–µ—Ä–º–∞–Ω–∏—è",
            flag: "üá©üá™",
            difficulty: "–°—Ä–µ–¥–Ω—è—è",
            bonus: 8,
            specialties: ["–∞–≤—Ç–æ–ø—Ä–æ–º", "–º–∞—à–∏–Ω–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ", "—Ö–∏–º–∏—è", "—ç–∫—Å–ø–æ—Ä—Ç"],
            base_modifiers: {
                gdpIdx: 5,
                expIdx: 8,
                impIdx: 3,
                cpi: -0.5,
                unemployment: -1.0
            }
        },
        JP: {
            name: "–Ø–ø–æ–Ω–∏—è",
            flag: "üáØüáµ",
            difficulty: "–°–ª–æ–∂–Ω–∞—è",
            bonus: 10,
            specialties: ["—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", "–∞–≤—Ç–æ–ø—Ä–æ–º", "—Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞", "—Ç–æ—á–Ω–æ–µ –º–∞—à–∏–Ω–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ"],
            base_modifiers: {
                gdpIdx: 3,
                expIdx: 5,
                impIdx: 8,
                cpi: -0.8,
                unemployment: -0.3
            }
        },
        RU: {
            name: "–†–æ—Å—Å–∏—è",
            flag: "üá∑üá∫",
            difficulty: "–û—á–µ–Ω—å —Å–ª–æ–∂–Ω–∞—è",
            bonus: 12,
            specialties: ["—ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞", "—Å—ã—Ä—å—ë", "IT", "–æ–±–æ—Ä–æ–Ω–ø—Ä–æ–º"],
            base_modifiers: {
                gdpIdx: 0,
                expIdx: 5,
                impIdx: -3,
                cpi: 0.5,
                unemployment: 1.0
            }
        },
        BR: {
            name: "–ë—Ä–∞–∑–∏–ª–∏—è",
            flag: "üáßüá∑",
            difficulty: "–≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ —Å–ª–æ–∂–Ω–∞—è",
            bonus: 15,
            specialties: ["–∞–≥—Ä–æ–ø—Ä–æ–º", "—Å—ã—Ä—å—ë", "—ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞", "–º–µ—Ç–∞–ª–ª—É—Ä–≥–∏—è"],
            base_modifiers: {
                gdpIdx: -2,
                expIdx: 3,
                impIdx: -5,
                cpi: 1.5,
                unemployment: 2.0
            }
        }
    },
    trustWeights: {
        "–ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã": 8,
        "–ø—Ä–∞–≤–æ": 7,
        "–æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å": 7,
        "–¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è": 6,
        "—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å": 5,
        "—Å—É–±—Å–∏–¥–∏–∏": 2,
        "—Å–∞–Ω–∫—Ü–∏–∏": -6,
        "—Ç–µ—Ö–∫–æ–Ω—Ç—Ä–æ–ª—å": -5,
        "—ç—Å–∫–∞–ª–∞—Ü–∏—è": -8,
        "–∫–≤–æ—Ç—ã": -6,
        "safeguard": -5,
        "–ø—Ä–æ—Ç–µ–∫—Ü–∏–æ–Ω–∏–∑–º": -7,
        "—Ç–∞—Ä–∏—Ñ—ã": -4
    }
};

// –°–ª—É—á–∞–π–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –æ—Ç –¥—Ä—É–≥–∏—Ö —Å—Ç—Ä–∞–Ω
const randomEvents = {
    supportive: [
        {
            text: "–ï–° –ø—Ä–µ–¥–ª–æ–∂–∏–ª –ª—å–≥–æ—Ç–Ω—É—é —Ç–æ—Ä–≥–æ–≤—É—é –∫–≤–æ—Ç—É –≤ –∑–Ω–∞–∫ —Å–æ–ª–∏–¥–∞—Ä–Ω–æ—Å—Ç–∏",
            effect: { gdp: 0.3, exp: 0.8, imp: 0.2, cpi: -0.1, unemployment: -0.2 }
        },
        {
            text: "–Ø–ø–æ–Ω–∏—è –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∞ –≤ –≤–∞—à–∏ –∑–µ–ª–µ–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
            effect: { gdp: 0.5, exp: 0.3, imp: 0.1, cpi: 0.0, unemployment: -0.3 }
        },
        {
            text: "–°–®–ê –æ—Ç–∫—Ä—ã–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–≤–æ–µ–º—É —Ä—ã–Ω–∫—É",
            effect: { gdp: 0.4, exp: 1.2, imp: 0.0, cpi: -0.1, unemployment: -0.2 }
        },
        {
            text: "–ö–∏—Ç–∞–π –ø—Ä–µ–¥–ª–æ–∂–∏–ª —Å–æ–≤–º–µ—Å—Ç–Ω—ã–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã",
            effect: { gdp: 0.6, exp: 0.4, imp: 0.3, cpi: 0.1, unemployment: -0.4 }
        },
        {
            text: "–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π –≤–∞–ª—é—Ç–Ω—ã–π —Ñ–æ–Ω–¥ –æ–¥–æ–±—Ä–∏–ª –ª—å–≥–æ—Ç–Ω—ã–π –∫—Ä–µ–¥–∏—Ç",
            effect: { gdp: 0.8, exp: 0.2, imp: 0.5, cpi: 0.2, unemployment: -0.3 }
        }
    ],
    neutral: [
        {
            text: "–ú–∏—Ä–æ–≤—ã–µ —Ä—ã–Ω–∫–∏ –æ—Å—Ç–∞–ª–∏—Å—å –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã –∫ –≤–∞—à–µ–º—É —Ä–µ—à–µ–Ω–∏—é",
            effect: { gdp: 0.0, exp: 0.0, imp: 0.0, cpi: 0.0, unemployment: 0.0 }
        },
        {
            text: "–¢–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—Ç–Ω–µ—Ä—ã –∑–∞–Ω—è–ª–∏ –≤—ã–∂–∏–¥–∞—Ç–µ–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é",
            effect: { gdp: 0.1, exp: 0.0, imp: 0.0, cpi: 0.0, unemployment: 0.0 }
        },
        {
            text: "–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤—ã–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–∞ –≤–æ–∑–¥–µ—Ä–∂–∞–ª–∏—Å—å –æ—Ç –æ—Ü–µ–Ω–æ–∫",
            effect: { gdp: 0.0, exp: 0.1, imp: 0.0, cpi: 0.0, unemployment: 0.0 }
        }
    ],
    hostile: [
        {
            text: "–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã –≤–≤–µ–ª–∏ –æ—Ç–≤–µ—Ç–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è",
            effect: { gdp: -0.4, exp: -0.8, imp: -0.3, cpi: 0.2, unemployment: 0.3 }
        },
        {
            text: "–ö—Ä—É–ø–Ω—ã–π –∏–Ω–≤–µ—Å—Ç–æ—Ä –æ—Ç–æ–∑–≤–∞–ª —Å—Ä–µ–¥—Å—Ç–≤–∞ –∏–∑ –≤–∞—à–µ–π —ç–∫–æ–Ω–æ–º–∏–∫–∏",
            effect: { gdp: -0.6, exp: -0.2, imp: -0.4, cpi: 0.1, unemployment: 0.4 }
        },
        {
            text: "–¢–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—Ç–Ω–µ—Ä—ã –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç —É—Å–ª–æ–≤–∏—è —Å–æ–≥–ª–∞—à–µ–Ω–∏–π",
            effect: { gdp: -0.3, exp: -0.6, imp: 0.0, cpi: 0.1, unemployment: 0.2 }
        },
        {
            text: "–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ —Å–∞–Ω–∫—Ü–∏–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–ª–∏ –¥–æ—Å—Ç—É–ø –∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º",
            effect: { gdp: -0.5, exp: -0.4, imp: -0.8, cpi: 0.3, unemployment: 0.5 }
        },
        {
            text: "–ö—É—Ä—Å –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –≤–∞–ª—é—Ç—ã —É–ø–∞–ª –∏–∑-–∑–∞ –Ω–µ–¥–æ–≤–µ—Ä–∏—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤",
            effect: { gdp: -0.4, exp: 0.2, imp: -0.6, cpi: 0.4, unemployment: 0.3 }
        }
    ]
};

// –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (100 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
const scenarios = {
    // –°—Ç–∞—Ç–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ (15 —à—Ç)
    static: [
        {
            id: "steel-dumping",
            text: "–î–µ–º–ø–∏–Ω–≥ —Å—Ç–∞–ª–∏ –¥–∞–≤–∏—Ç –Ω–∞ –æ—Ç—Ä–∞—Å–ª—å. –ß—Ç–æ –¥–µ–ª–∞–µ–º?",
            choices: [
                {
                    id: "high-tariff",
                    icon: "fa-solid fa-industry",
                    label: "–í—ã—Å–æ–∫–∏–µ —Ç–∞—Ä–∏—Ñ—ã (–Ω–∞—Ü–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)",
                    hint: "–ë—ã—Å—Ç—Ä–∞—è –∑–∞—â–∏—Ç–∞ ‚Üí —Ä–∏—Å–∫ –æ—Ç–≤–µ—Ç–Ω—ã—Ö –º–µ—Ä",
                    effect: { gdp: -1.3, exp: -1.9, imp: -2.5, cpi: 0.3, unemployment: -0.5 },
                    tags: ["—Ç–∞—Ä–∏—Ñ—ã", "—ç—Å–∫–∞–ª–∞—Ü–∏—è"],
                    economicTheory: "–¢–∞—Ä–∏—Ñ—ã —Å–æ–∑–¥–∞—é—Ç –º–µ—Ä—Ç–≤—ã–π –≥—Ä—É–∑ –ø–æ—Ç–µ—Ä—å –¥–ª—è –æ–±—â–µ—Å—Ç–≤–∞. –ü–æ —Ç–µ–æ—Ä–∏–∏ –°—Ç–∏–≥–ª–∏—Ü–∞, —Ç–∞—Ä–∏—Ñ—ã —Å–Ω–∏–∂–∞—é—Ç –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –±–ª–∞–≥–æ—Å–æ—Å—Ç–æ—è–Ω–∏–µ, –ø–æ—Å–∫–æ–ª—å–∫—É –ø–æ—Ç–µ—Ä–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π –ø—Ä–µ–≤—ã—à–∞—é—Ç –≤—ã–≥–æ–¥—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π –∏ –Ω–∞–ª–æ–≥–æ–≤—ã–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è. –í –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ —Ç–∞—Ä–∏—Ñ—ã –∑–∞—â–∏—â–∞—é—Ç –æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω—É—é –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å –æ—Ç –Ω–µ–¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏, –Ω–æ –≤ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ —Å–Ω–∏–∂–∞—é—Ç —Å—Ç–∏–º—É–ª—ã –∫ –∏–Ω–Ω–æ–≤–∞—Ü–∏—è–º –∏ –ø–æ–≤—ã—à–∞—é—Ç —Ü–µ–Ω—ã –¥–ª—è –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π.",
                    history: "–í 2018 –≥–æ–¥—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –¢—Ä–∞–º–ø–∞ –≤–≤–µ–ª–∞ –ø–æ—à–ª–∏–Ω—ã –Ω–∞ –∏–º–ø–æ—Ä—Ç —Å—Ç–∞–ª–∏ –≤ —Ä–∞–∑–º–µ—Ä–µ 25% –∏ –∞–ª—é–º–∏–Ω–∏—è –≤ —Ä–∞–∑–º–µ—Ä–µ 10% —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–∞–∑–¥–µ–ª—É 232 –æ –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ú–µ—Ä—ã –∑–∞—Ç—Ä–æ–Ω—É–ª–∏ –∏–º–ø–æ—Ä—Ç –Ω–∞ $48 –º–ª—Ä–¥ –∏ –≤—ã–∑–≤–∞–ª–∏ –æ—Ç–≤–µ—Ç–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –æ—Ç –ï–° ($3.2 –º–ª—Ä–¥), –ö–∞–Ω–∞–¥—ã ($12.8 –º–ª—Ä–¥), –ú–µ–∫—Å–∏–∫–∏ ($3 –º–ª—Ä–¥), –¢—É—Ä—Ü–∏–∏ ($1.8 –º–ª—Ä–¥) –∏ –¥—Ä—É–≥–∏—Ö —Å—Ç—Ä–∞–Ω. –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è Peterson Institute –ø–æ–∫–∞–∑–∞–ª–∏, —á—Ç–æ –ø–æ—à–ª–∏–Ω—ã –ø—Ä–∏–≤–µ–ª–∏ –∫ —Ä–æ—Å—Ç—É —Ü–µ–Ω –Ω–∞ —Å—Ç–∞–ª—å –Ω–∞ 30%, –ø–æ—Ç–µ—Ä–µ 75,000 —Ä–∞–±–æ—á–∏—Ö –º–µ—Å—Ç –≤ –æ—Ç—Ä–∞—Å–ª—è—Ö-–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ö —Å—Ç–∞–ª–∏, –Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é 8,700 –º–µ—Å—Ç –≤ —Å—Ç–∞–ª–µ–ª–∏—Ç–µ–π–Ω–æ–π –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏."
                },
                {
                    id: "anti-dumping",
                    icon: "fa-solid fa-scale-balanced",
                    label: "–ê–Ω—Ç–∏–¥–µ–º–ø–∏–Ω–≥–æ–≤—ã–µ –º–µ—Ä—ã (—Ç–æ—á–µ—á–Ω–æ)",
                    hint: "–°–ª–µ–¥—É–µ–º –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º –∏ —Ç–∞—Ä–≥–µ—Ç–∏—Ä—É–µ–º",
                    effect: { gdp: 0.3, exp: -0.4, imp: -1.0, cpi: 0.1, unemployment: -0.2 },
                    tags: ["–ø—Ä–∞–≤–æ"],
                    economicTheory: "–ê–Ω—Ç–∏–¥–µ–º–ø–∏–Ω–≥–æ–≤—ã–µ –º–µ—Ä—ã –±–∞–∑–∏—Ä—É—é—Ç—Å—è –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–µ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏–∑ —Ç–µ–æ—Ä–∏–∏ –í–∏–Ω–µ—Ä–∞-–î–∂–æ–Ω—Å–æ–Ω–∞. –û–Ω–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ—Ç–∏–≤ –ø—Ä–æ–¥–∞–∂–∏ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∏–∂–µ —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏–ª–∏ –Ω–∏–∂–µ —Ü–µ–Ω –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º —Ä—ã–Ω–∫–µ —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–∞. –û–¥–Ω–∞–∫–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ '–Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏' —Å–ª–æ–∂–Ω–æ –∏ —á–∞—Å—Ç–æ –ø–æ–ª–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–æ. –°–æ–≥–ª–∞—Å–Ω–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è–º –ë–ª–æ–Ω–¥–µ—Ä–∞ –∏ –§—Ä–∞–Ω—Å—É–∞, –∞–Ω—Ç–∏–¥–µ–º–ø–∏–Ω–≥–æ–≤—ã–µ –º–µ—Ä—ã —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞–∫ –∑–∞–≤—É–∞–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ç–µ–∫—Ü–∏–æ–Ω–∏–∑–º.",
                    history: "–ï–° –ø—Ä–∏–º–µ–Ω—è–ª –∞–Ω—Ç–∏–¥–µ–º–ø–∏–Ω–≥–æ–≤—ã–µ –º–µ—Ä—ã –ø—Ä–æ—Ç–∏–≤ –∫–∏—Ç–∞–π—Å–∫–æ–π —Å—Ç–∞–ª–∏ —Å 2013 –ø–æ 2018 –≥–æ–¥, —É—Å—Ç–∞–Ω–æ–≤–∏–≤ –ø–æ—à–ª–∏–Ω—ã –æ—Ç 17.2% –¥–æ 73.7% –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∏–¥—ã —Å—Ç–∞–ª—å–Ω–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏. –≠—Ç–æ –ø–æ–º–æ–≥–ª–æ –µ–≤—Ä–æ–ø–µ–π—Å–∫–∏–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è–º: ArcelorMittal —É–≤–µ–ª–∏—á–∏–ª –ø—Ä–∏–±—ã–ª—å –Ω–∞ 40%, Tata Steel –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å. –û–¥–Ω–∞–∫–æ —Ü–µ–Ω—ã –Ω–∞ —Å—Ç–∞–ª—å –≤—ã—Ä–æ—Å–ª–∏ –Ω–∞ 15-20%, —á—Ç–æ —É–≤–µ–ª–∏—á–∏–ª–æ –∏–∑–¥–µ—Ä–∂–∫–∏ –∞–≤—Ç–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π (Volkswagen, BMW) –∏ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π. –ö–∏—Ç–∞–π—Å–∫–∏–π —ç–∫—Å–ø–æ—Ä—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏–ª—Å—è –≤ –ê—Ñ—Ä–∏–∫—É –∏ –õ–∞—Ç–∏–Ω—Å–∫—É—é –ê–º–µ—Ä–∏–∫—É."
                },
                {
                    id: "wait-see",
                    icon: "fa-regular fa-clock",
                    label: "–í—ã–∂–∏–¥–∞—Ç—å",
                    hint: "–¶–µ–Ω—ã –Ω–∏–∑–∫–∏–µ, –Ω–æ –æ—Ç—Ä–∞—Å–ª—å —Å—Ç—Ä–∞–¥–∞–µ—Ç",
                    effect: { gdp: -0.6, exp: 0.0, imp: 1.5, cpi: -0.2, unemployment: 0.8 },
                    tags: ["–æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å"],
                    economicTheory: "–ü–æ–¥—Ö–æ–¥ –Ω–µ–≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π —Ç–µ–æ—Ä–∏–∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ –†–∏–∫–∞—Ä–¥–æ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ç–µ–æ—Ä–∏–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏ –°–∞–º—É—ç–ª—å—Å–æ–Ω–∞. –°–≤–æ–±–æ–¥–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É–µ—Ç –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –±–ª–∞–≥–æ—Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤. –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏ –≤ –Ω–µ–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω—ã—Ö –æ—Ç—Ä–∞—Å–ª—è—Ö –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—Ç—Å—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–º–∏ –≤—ã–≥–æ–¥–∞–º–∏ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∫–∏ –≤ —Ü–µ–ª–æ–º.",
                    history: "–í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è –≤ 1846 –≥–æ–¥—É –æ—Ç–º–µ–Ω–∏–ª–∞ –•–ª–µ–±–Ω—ã–µ –∑–∞–∫–æ–Ω—ã (—Ç–∞—Ä–∏—Ñ—ã –Ω–∞ –∏–º–ø–æ—Ä—Ç –∑–µ—Ä–Ω–∞), –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ –∑–µ–º–ª–µ–≤–ª–∞–¥–µ–ª—å—Ü–µ–≤. –û—Ç–º–µ–Ω–∞ –ø—Ä–∏–≤–µ–ª–∞ –∫ –ø–∞–¥–µ–Ω–∏—é —Ü–µ–Ω –Ω–∞ —Ö–ª–µ–± –Ω–∞ 25%, –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–º —Ç—Ä—É–¥–Ω–æ—Å—Ç—è–º –≤ —Å–µ–ª—å—Å–∫–æ–º —Ö–æ–∑—è–π—Å—Ç–≤–µ (–±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ 15% —Ñ–µ—Ä–º–µ—Ä–æ–≤), –Ω–æ —Å—Ç–∏–º—É–ª–∏—Ä–æ–≤–∞–ª–∞ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å –∏ —Ç–æ—Ä–≥–æ–≤–ª—é. –í–í–ü –í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏–∏ —Ä–æ—Å –Ω–∞ 2.5% –µ–∂–µ–≥–æ–¥–Ω–æ –≤ 1850-1870 –≥–æ–¥–∞—Ö, —Ä–µ–∞–ª—å–Ω—ã–µ –¥–æ—Ö–æ–¥—ã —Ä–∞–±–æ—á–∏—Ö –≤—ã—Ä–æ—Å–ª–∏ –Ω–∞ 40%, —Å—Ç—Ä–∞–Ω–∞ —Å—Ç–∞–ª–∞ '–º–∞—Å—Ç–µ—Ä—Å–∫–æ–π –º–∏—Ä–∞'."
                }
            ]
        },
        {
            id: "energy-crisis",
            text: "–≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π –∫—Ä–∏–∑–∏—Å: —Ü–µ–Ω—ã –Ω–∞ –≥–∞–∑ –≤—ã—Ä–æ—Å–ª–∏ –≤ 3 —Ä–∞–∑–∞. –í–∞—à–∏ –¥–µ–π—Å—Ç–≤–∏—è?",
            choices: [
                {
                    id: "subsidies-energy",
                    icon: "fa-solid fa-fire",
                    label: "–°—É–±—Å–∏–¥–∏—Ä–æ–≤–∞—Ç—å —ç–Ω–µ—Ä–≥–∏—é",
                    hint: "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–∏–∑–Ω–µ—Å–∞ –∏ –Ω–∞—Å–µ–ª–µ–Ω–∏—è",
                    effect: { gdp: 0.8, exp: 0.5, imp: 2.0, cpi: -0.5, unemployment: -1.2 },
                    tags: ["—Å—É–±—Å–∏–¥–∏–∏"],
                    economicTheory: "–≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–µ —Å—É–±—Å–∏–¥–∏–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –ø—Ä–∏–º–µ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—â–µ–π —Ñ–∏—Å–∫–∞–ª—å–Ω–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏ –≤ —Ç–µ–æ—Ä–∏–∏ –ö–µ–π–Ω—Å–∞. –û–Ω–∏ —Å–Ω–∏–∂–∞—é—Ç –∏–∑–¥–µ—Ä–∂–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—è —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –ø–µ—Ä–∏–æ–¥ —à–æ–∫–∞. –û–¥–Ω–∞–∫–æ —Å–æ–∑–¥–∞—é—Ç —Ñ–∏—Å–∫–∞–ª—å–Ω–æ–µ –±—Ä–µ–º—è –∏ –∏—Å–∫–∞–∂–∞—é—Ç —Ü–µ–Ω–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–µ—Ä–µ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—é —ç–Ω–µ—Ä–≥–∏–∏ –∏ —Å–Ω–∏–∂–µ–Ω–∏—é —Å—Ç–∏–º—É–ª–æ–≤ –∫ —ç–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–∂–µ–Ω–∏—é. –¢–µ–æ—Ä–∏—è –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –ë—å—é–∫–µ–Ω–µ–Ω–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–º–µ–Ω—ã —Å—É–±—Å–∏–¥–∏–π –≤ –±—É–¥—É—â–µ–º –∏–∑-–∑–∞ –ª–æ–±–±–∏—Å—Ç—Å–∫–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è.",
                    history: "–ï–≤—Ä–æ–ø–∞ –≤ 2022-2023 –≥–æ–¥–∞—Ö –≤—ã–¥–µ–ª–∏–ª–∞ –±–æ–ª–µ–µ ‚Ç¨780 –º–ª—Ä–¥ –Ω–∞ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–µ —Å—É–±—Å–∏–¥–∏–∏. –ì–µ—Ä–º–∞–Ω–∏—è –ø–æ—Ç—Ä–∞—Ç–∏–ª–∞ ‚Ç¨264 –º–ª—Ä–¥ (7.5% –í–í–ü): ‚Ç¨200 –º–ª—Ä–¥ –Ω–∞ '–¥–≤–æ–π–Ω–æ–π —Ç–æ—Ä–º–æ–∑' –∏ ‚Ç¨64 –º–ª—Ä–¥ –Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä—ã. –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏–ª–æ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫—É—é –±–µ–¥–Ω–æ—Å—Ç—å (–∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ —ç–Ω–µ—Ä–≥–∏—é –æ—Å—Ç–∞–ª–∏—Å—å –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 6% –¥–æ—Ö–æ–¥–æ–≤), –º–∞—Å—Å–æ–≤—ã–µ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–∞ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏, –Ω–æ –ø—Ä–∏–≤–µ–ª–æ –∫ —Ä–æ—Å—Ç—É –≥–æ—Å–¥–æ–ª–≥–∞ –ì–µ—Ä–º–∞–Ω–∏–∏ —Å 69% –¥–æ 84% –í–í–ü –∏ —Å–æ–∑–¥–∞–ª–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –±–∏–∑–Ω–µ—Å–∞ –æ—Ç –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏."
                },
                {
                    id: "market-forces",
                    icon: "fa-solid fa-chart-line",
                    label: "–ü–æ–∑–≤–æ–ª–∏—Ç—å —Ä—ã–Ω–∫—É –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è",
                    hint: "–í—ã—Å–æ–∫–∏–µ —Ü–µ–Ω—ã —Å—Ç–∏–º—É–ª–∏—Ä—É—é—Ç —ç–∫–æ–Ω–æ–º–∏—é",
                    effect: { gdp: -2.1, exp: -1.5, imp: -0.5, cpi: 1.8, unemployment: 2.5 },
                    tags: ["–æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å"],
                    economicTheory: "–†—ã–Ω–æ—á–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –∞–≤—Å—Ç—Ä–∏–π—Å–∫–æ–π —à–∫–æ–ª–µ —ç–∫–æ–Ω–æ–º–∏–∫–∏ (–ú–∏–∑–µ—Å, –•–∞–π–µ–∫) –∏ —Ç–µ–æ—Ä–∏–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö —Ä—ã–Ω–∫–æ–≤ –§–∞–º—ã. –í—ã—Å–æ–∫–∏–µ —Ü–µ–Ω—ã —Å–ª—É–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–º —Å–∏–≥–Ω–∞–ª–æ–º, —Å—Ç–∏–º—É–ª–∏—Ä—É—é—â–∏–º —ç–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–∂–µ–Ω–∏–µ, –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏–Ω–Ω–æ–≤–∞—Ü–∏–∏. –ö—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ä–µ—Ü–µ—Å—Å–∏—è —É—Å–∫–æ—Ä—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—É—é –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫—É —ç–∫–æ–Ω–æ–º–∏–∫–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—É —ç–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, —Å–æ–∑–¥–∞–≤–∞—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞.",
                    history: "–ü–æ—Å–ª–µ –Ω–µ—Ñ—Ç—è–Ω—ã—Ö –∫—Ä–∏–∑–∏—Å–æ–≤ 1973 –∏ 1979 –≥–æ–¥–æ–≤ —Å—Ç—Ä–∞–Ω—ã –≤—ã–±—Ä–∞–ª–∏ —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏. –°–®–ê –∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –µ–≤—Ä–æ–ø–µ–π—Å–∫–∏—Ö —Å—Ç—Ä–∞–Ω, –Ω–µ —Å—É–±—Å–∏–¥–∏—Ä–æ–≤–∞–≤—à–∏–µ —Ç–æ–ø–ª–∏–≤–æ, –¥–æ–±–∏–ª–∏—Å—å –≤–ø–µ—á–∞—Ç–ª—è—é—â–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: —ç–Ω–µ—Ä–≥–æ–µ–º–∫–æ—Å—Ç—å –í–í–ü –°–®–ê —Å–Ω–∏–∑–∏–ª–∞—Å—å –Ω–∞ 60% —Å 1970 –ø–æ 2010 –≥–æ–¥. –Ø–ø–æ–Ω–∏—è —Å—Ç–∞–ª–∞ –ª–∏–¥–µ—Ä–æ–º —ç–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, —Å–Ω–∏–∑–∏–≤ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É –í–í–ü –Ω–∞ 37%. –î–∞–Ω–∏—è –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∞ –≤ –≤–µ—Ç—Ä–æ—ç–Ω–µ—Ä–≥–µ—Ç–∏–∫—É, –∫ 2020 –≥–æ–¥—É 80% —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–æ—Å—å –∏–∑ –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤."
                },
                {
                    id: "strategic-reserves",
                    icon: "fa-solid fa-warehouse",
                    label: "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑–µ—Ä–≤—ã",
                    hint: "–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ",
                    effect: { gdp: 0.3, exp: 0.0, imp: 0.5, cpi: -0.8, unemployment: -0.3 },
                    tags: ["—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å"],
                    economicTheory: "–°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑–µ—Ä–≤—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Ñ–æ—Ä–º—É —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–≥–æ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ç–∏–≤ –≤–Ω–µ—à–Ω–∏—Ö —à–æ–∫–æ–≤ –≤ —Ç–µ–æ—Ä–∏–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ú–∞—Ä–∫–æ–≤–∏—Ü–∞. –û–Ω–∏ —Å–ª—É–∂–∞—Ç –±—É—Ñ–µ—Ä–æ–º –ø—Ä–æ—Ç–∏–≤ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ —Ü–µ–Ω –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫—É—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å. –û–¥–Ω–∞–∫–æ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ä–∞, —Ç—Ä–µ–±—É—é—â–∞—è —Ç—â–∞—Ç–µ–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–æ—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –∏ –∏—Å—Ç–æ—â–µ–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–æ–≤ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –º–æ–º–µ–Ω—Ç.",
                    history: "–°–®–ê —Å–æ–∑–¥–∞–ª–∏ –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–π –Ω–µ—Ñ—Ç—è–Ω–æ–π —Ä–µ–∑–µ—Ä–≤ –≤ 1975 –≥–æ–¥—É –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –Ω–µ—Ñ—Ç—è–Ω–æ–≥–æ –∫—Ä–∏–∑–∏—Å–∞. –í 2022 –≥–æ–¥—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –ë–∞–π–¥–µ–Ω–∞ –≤—ã–ø—É—Å—Ç–∏–ª–∞ —Ä–µ–∫–æ—Ä–¥–Ω—ã–µ 180 –º–ª–Ω –±–∞—Ä—Ä–µ–ª–µ–π (26% –æ—Ç –æ–±—â–µ–≥–æ –æ–±—ä–µ–º–∞) –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ —Ü–µ–Ω –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –≤ –£–∫—Ä–∞–∏–Ω–µ. –≠—Ç–æ –ø–æ–º–æ–≥–ª–æ —Å–Ω–∏–∑–∏—Ç—å —Ü–µ–Ω—ã –Ω–∞ –±–µ–Ω–∑–∏–Ω —Å $5.01 –¥–æ $3.68 –∑–∞ –≥–∞–ª–ª–æ–Ω, —Å—ç–∫–æ–Ω–æ–º–∏–≤ –∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–º –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è–º –æ–∫–æ–ª–æ $100 –º–ª—Ä–¥. –û–¥–Ω–∞–∫–æ —Ä–µ–∑–µ—Ä–≤—ã —Å–æ–∫—Ä–∞—Ç–∏–ª–∏—Å—å –¥–æ 351 –º–ª–Ω –±–∞—Ä—Ä–µ–ª–µ–π ‚Äî –º–∏–Ω–∏–º—É–º–∞ —Å 1984 –≥–æ–¥–∞."
                }
            ]
        },
        // –î–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ 13 —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤...
        {
            id: "trade-war",
            text: "–¢–æ—Ä–≥–æ–≤–∞—è –≤–æ–π–Ω–∞ —ç—Å–∫–∞–ª–∏—Ä—É–µ—Ç: –ø–∞—Ä—Ç–Ω—ë—Ä —É–≥—Ä–æ–∂–∞–µ—Ç –ø–æ—à–ª–∏–Ω–∞–º–∏ –Ω–∞ $200 –º–ª—Ä–¥ —Ç–æ–≤–∞—Ä–æ–≤.",
            choices: [
                {
                    id: "retaliate",
                    icon: "fa-solid fa-fist-raised",
                    label: "–°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –æ—Ç–≤–µ—Ç",
                    hint: "–û–∫–æ –∑–∞ –æ–∫–æ",
                    effect: { gdp: -1.8, exp: -2.3, imp: -1.7, cpi: 0.9, unemployment: 1.4 },
                    tags: ["—ç—Å–∫–∞–ª–∞—Ü–∏—è", "—Ç–∞—Ä–∏—Ñ—ã"],
                    economicTheory: "–¢–æ—Ä–≥–æ–≤—ã–µ –≤–æ–π–Ω—ã –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø—Ä–∏–∑–º—É —Ç–µ–æ—Ä–∏–∏ –∏–≥—Ä –ù—ç—à–∞ –∏ –º–æ–¥–µ–ª—å '–¥–∏–ª–µ–º–º—ã –∑–∞–∫–ª—é—á–µ–Ω–Ω–æ–≥–æ' –≤ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤–æ–∑–º–µ–∑–¥–∏—è –º–æ–∂–µ—Ç —Å–¥–µ—Ä–∂–∞—Ç—å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞ (credible threat), –Ω–æ –≤–∑–∞–∏–º–Ω–∞—è —ç—Å–∫–∞–ª–∞—Ü–∏—è —á–∞—Å—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—é –ù—ç—à–∞ —Å –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –≥–¥–µ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã –ø—Ä–æ–∏–≥—Ä—ã–≤–∞—é—Ç. –ú–æ–¥–µ–ª–∏ CGE –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ —Ç–æ—Ä–≥–æ–≤—ã–µ –≤–æ–π–Ω—ã —Å–Ω–∏–∂–∞—é—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π –í–í–ü –Ω–∞ 1-2% —á–µ—Ä–µ–∑ —Ä–∞–∑—Ä—É—à–µ–Ω–∏–µ —Ü–µ–ø–æ—á–µ–∫ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏.",
                    history: "–¢–æ—Ä–≥–æ–≤–∞—è –≤–æ–π–Ω–∞ –°–®–ê-–ö–∏—Ç–∞–π 2018-2020 —Å—Ç–∞–ª–∞ –∫—Ä—É–ø–Ω–µ–π—à–µ–π –ø–æ—Å–ª–µ –≤–æ–π–Ω—ã –°–º—É—Ç-–•–æ—É–ª–∏ 1930 –≥–æ–¥–∞. –°–®–ê –Ω–∞–ª–æ–∂–∏–ª–∏ –ø–æ—à–ª–∏–Ω—ã –Ω–∞ –∫–∏—Ç–∞–π—Å–∫–∏–µ —Ç–æ–≤–∞—Ä—ã –Ω–∞ $360 –º–ª—Ä–¥, –ö–∏—Ç–∞–π –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞ $185 –º–ª—Ä–¥ –∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞. –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ Federal Reserve –ø–æ–∫–∞–∑–∞–ª–æ: –∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–π –í–í–ü —Å–Ω–∏–∑–∏–ª—Å—è –Ω–∞ 0.3%, –∫–∏—Ç–∞–π—Å–∫–∏–π ‚Äî –Ω–∞ 0.8%. –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ –°–®–ê –∑–∞–ø–ª–∞—Ç–∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ $51 –º–ª—Ä–¥ –≤ –≤–∏–¥–µ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏—Ö —Ü–µ–Ω. –¢–æ—Ä–≥–æ–≤—ã–π –¥–µ—Ñ–∏—Ü–∏—Ç –°–®–ê —Å –ö–∏—Ç–∞–µ–º –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è, –Ω–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏–ª—Å—è —á–µ—Ä–µ–∑ –í—å–µ—Ç–Ω–∞–º –∏ –ú–µ–∫—Å–∏–∫—É."
                },
                {
                    id: "negotiate",
                    icon: "fa-solid fa-handshake",
                    label: "–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã",
                    hint: "–ü–æ–∏—Å–∫ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å–∞",
                    effect: { gdp: 0.4, exp: 0.8, imp: 0.6, cpi: -0.2, unemployment: -0.5 },
                    tags: ["–ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã", "–æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å"],
                    economicTheory: "–¢–µ–æ—Ä–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤ –ë–∞–≥–≤–µ–ª–ª–∞-–°—Ç–∞–π–≥–µ—Ä–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –≤–∑–∞–∏–º–æ–≤—ã–≥–æ–¥–Ω—ã—Ö —Å–æ–≥–ª–∞—à–µ–Ω–∏–π –ø—Ä–∏ —É—á–µ—Ç–µ –≤–Ω–µ—à–Ω–∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏. –£—Å–ø–µ—à–Ω—ã–µ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã —Ç—Ä–µ–±—É—é—Ç '–ø—Ä–æ–±–ª–µ–º–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ' –ø–æ–¥—Ö–æ–¥–∞ —Å –≤–∑–∞–∏–º–Ω—ã–º–∏ —É—Å—Ç—É–ø–∫–∞–º–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Å—Ñ–µ—Ä–∞—Ö, —Å–æ–∑–¥–∞–≤–∞—è –ø–∞–∫–µ—Ç–Ω—ã–µ —Å–¥–µ–ª–∫–∏ (package deals), –∫–æ—Ç–æ—Ä—ã–µ –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É—é—Ç —Å–æ–≤–æ–∫—É–ø–Ω—ã–µ –≤—ã–≥–æ–¥—ã. –¢–µ–æ—Ä–∏—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –∏–≥—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É—é—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ.",
                    history: "–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã –ø–æ –ù–ê–§–¢–ê 1991-1993 –≥–æ–¥–æ–≤ –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∏ —Ç–æ—Ä–≥–æ–≤—ã–µ —Å–ø–æ—Ä—ã –≤ –∫—Ä—É–ø–Ω–µ–π—à—É—é –∑–æ–Ω—É —Å–≤–æ–±–æ–¥–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏. –°–®–ê –æ—Ç–∫–∞–∑–∞–ª–∏—Å—å –æ—Ç –ø—Ä–æ—Ç–µ–∫—Ü–∏–æ–Ω–∏–∑–º–∞ –≤ —Å–µ–ª—å—Å–∫–æ–º —Ö–æ–∑—è–π—Å—Ç–≤–µ, –ú–µ–∫—Å–∏–∫–∞ ‚Äî –æ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏, –ö–∞–Ω–∞–¥–∞ ‚Äî –æ—Ç –∫—É–ª—å—Ç—É—Ä–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π. –¢—Ä–µ—Ö—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–æ–±–æ—Ä–æ—Ç –≤—ã—Ä–æ—Å —Å $290 –º–ª—Ä–¥ –≤ 1993 –¥–æ $1.3 —Ç—Ä–ª–Ω –≤ 2020 –≥–æ–¥—É. –ù–ê–§–¢–ê —Å–æ–∑–¥–∞–ª–∞ 6 –º–ª–Ω —Ä–∞–±–æ—á–∏—Ö –º–µ—Å—Ç, –ø–æ–≤—ã—Å–∏–ª–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ 25%, –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–ª–∞ —Å–µ–≤–µ—Ä–æ–∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–µ —Ü–µ–ø–æ—á–∫–∏ –ø–æ—Å—Ç–∞–≤–æ–∫."
                }
            ]
        }
        // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∞—Ç–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
    ],
    
    // –û–±—â–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω (67 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
    general: [
        {
            id: "wto-dispute",
            text: "–í –í–¢–û –ø–æ–¥–∞–Ω–∞ –∂–∞–ª–æ–±–∞ –Ω–∞ –Ω–∞—à–∏ —Å—É–±—Å–∏–¥–∏–∏. –ö–∞–∫ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å?",
            choices: [
                {
                    id: "defend-subsidies",
                    icon: "fa-solid fa-shield",
                    label: "–ó–∞—â–∏—â–∞—Ç—å —Å—É–±—Å–∏–¥–∏–∏",
                    hint: "–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–µ—Å—ã –≤–∞–∂–Ω–µ–µ",
                    effect: { gdp: 0.5, exp: 0.8, imp: -0.3, cpi: 0.2, unemployment: -0.8 },
                    tags: ["–ø—Ä–æ—Ç–µ–∫—Ü–∏–æ–Ω–∏–∑–º"]
                },
                {
                    id: "comply-wto",
                    icon: "fa-solid fa-balance-scale",
                    label: "–°–æ–±–ª—é–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –í–¢–û",
                    hint: "–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–µ –ø—Ä–∞–≤–æ –ø—Ä–µ–≤—ã—à–µ –≤—Å–µ–≥–æ",
                    effect: { gdp: -0.8, exp: -0.5, imp: 0.5, cpi: -0.1, unemployment: 1.2 },
                    tags: ["–ø—Ä–∞–≤–æ", "–æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å"]
                }
            ]
        }
        // ... –¥–æ–±–∞–≤–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ 66 –æ–±—â–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
    ],
    
    // –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω—ã (33 —Å—Ü–µ–Ω–∞—Ä–∏—è)
    country_specific: {
        US: [
            {
                id: "us-tech-export",
                text: "–ö–æ–Ω–≥—Ä–µ—Å—Å –æ–±—Å—É–∂–¥–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —ç–∫—Å–ø–æ—Ä—Ç –ø–æ–ª—É–ø—Ä–æ–≤–æ–¥–Ω–∏–∫–æ–≤. –ü–æ–∑–∏—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏?",
                choices: [
                    {
                        id: "tech-restrictions",
                        icon: "fa-solid fa-microchip",
                        label: "–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è",
                        hint: "–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–µ–≤—ã—à–µ –ø—Ä–∏–±—ã–ª–∏",
                        effect: { gdp: -0.8, exp: -2.1, imp: -0.4, cpi: 0.3, unemployment: 0.6 },
                        tags: ["—Ç–µ—Ö–∫–æ–Ω—Ç—Ä–æ–ª—å", "—Å–∞–Ω–∫—Ü–∏–∏"]
                    },
                    {
                        id: "free-tech-trade",
                        icon: "fa-solid fa-globe",
                        label: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–≤–æ–±–æ–¥–Ω—É—é —Ç–æ—Ä–≥–æ–≤–ª—é",
                        hint: "–ê–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –¥–æ–ª–∂–Ω—ã –∫–æ–Ω–∫—É—Ä–∏—Ä–æ–≤–∞—Ç—å",
                        effect: { gdp: 0.6, exp: 1.2, imp: 0.3, cpi: -0.1, unemployment: -0.4 },
                        tags: ["–æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å"]
                    }
                ]
            }
            // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ 32 US —Å—Ü–µ–Ω–∞—Ä–∏—è
        ],
        CN: [
            {
                id: "cn-belt-road",
                text: "–ü–∞—Ä—Ç–Ω–µ—Ä—ã –ø—Ä–æ—Å—è—Ç —É–≤–µ–ª–∏—á–∏—Ç—å —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤ '–ü–æ—è—Å–∞ –∏ –ø—É—Ç–∏'. –†–µ—à–µ–Ω–∏–µ?",
                choices: [
                    {
                        id: "expand-bri",
                        icon: "fa-solid fa-road",
                        label: "–£–≤–µ–ª–∏—á–∏—Ç—å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏",
                        hint: "–£–∫—Ä–µ–ø–ª—è–µ–º –≥–µ–æ–ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–æ–µ –≤–ª–∏—è–Ω–∏–µ",
                        effect: { gdp: -0.5, exp: 1.8, imp: 0.4, cpi: 0.2, unemployment: -0.3 },
                        tags: ["–¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è"]
                    },
                    {
                        id: "focus-domestic",
                        icon: "fa-solid fa-home",
                        label: "–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º —Ä—ã–Ω–∫–µ",
                        hint: "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ä–∞–∑–≤–∏—Ç–∏—é –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä–∞–Ω—ã",
                        effect: { gdp: 1.2, exp: -0.8, imp: -0.2, cpi: -0.1, unemployment: -0.8 },
                        tags: ["—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å"]
                    }
                ]
            }
            // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ 32 CN —Å—Ü–µ–Ω–∞—Ä–∏—è
        ],
        // –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞–Ω...
    }
};

// –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
let gameState = {
    currentScreen: 'start',
    selectedCountry: null,
    gameMode: 'normal',
    currentTurn: 0,
    currentScenario: null,
    selectedChoice: null,
    economicState: { ...gameData.baseState },
    trust: 50,
    history: [],
    randomEvents: [],
    charts: {},
    usedScenarios: [],
    availableScenarios: [],
    theme: 'auto'
};

// –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø–∞—Å—Ö–∞–ª–∫–∏
let logoTapCount = 0;
let logoTapTimer = null;
let keySequence = '';
let keySequenceTimer = null;
let keySequenceActive = false;

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ DOM
document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã...');
    initializeGame();
});

function initializeGame() {
    renderCountries();
    setupEventListeners();
    initializeTheme();
    setupEasterEgg();
    showScreen('start');
    updateVersionInfo();
}

function updateVersionInfo() {
    document.querySelectorAll('.game-version').forEach(el => {
        el.textContent = GAME_VERSION;
    });
}

// –°–∏—Å—Ç–µ–º–∞ —Ç–µ–º
function initializeTheme() {
    const savedTheme = localStorage.getItem('trade-wars-theme') || 'auto';
    gameState.theme = savedTheme;
    applyTheme(savedTheme);
    updateThemeIcon(savedTheme);
}

function applyTheme(theme) {
    const root = document.documentElement;
    if (theme === 'dark') {
        root.setAttribute('data-color-scheme', 'dark');
    } else if (theme === 'light') {
        root.setAttribute('data-color-scheme', 'light');
    } else {
        root.removeAttribute('data-color-scheme');
    }
}

function updateThemeIcon(theme) {
    const icon = document.querySelector('#themeToggle i');
    if (!icon) return;
    
    if (theme === 'dark') {
        icon.className = 'fas fa-moon';
    } else if (theme === 'light') {
        icon.className = 'fas fa-sun';
    } else {
        icon.className = 'fas fa-circle-half-stroke';
    }
}

function toggleTheme() {
    const themes = ['auto', 'light', 'dark'];
    const currentIndex = themes.indexOf(gameState.theme);
    const nextTheme = themes[(currentIndex + 1) % themes.length];
    
    gameState.theme = nextTheme;
    localStorage.setItem('trade-wars-theme', nextTheme);
    applyTheme(nextTheme);
    updateThemeIcon(nextTheme);
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
function generateRandomEvent(choice, scenarioTags) {
    const isCooperativeChoice = choice.tags && (
        choice.tags.includes('–ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã') || 
        choice.tags.includes('–æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å') || 
        choice.tags.includes('–ø—Ä–∞–≤–æ')
    );
    
    const isAggressiveChoice = choice.tags && (
        choice.tags.includes('—ç—Å–∫–∞–ª–∞—Ü–∏—è') || 
        choice.tags.includes('—Å–∞–Ω–∫—Ü–∏–∏') || 
        choice.tags.includes('–ø—Ä–æ—Ç–µ–∫—Ü–∏–æ–Ω–∏–∑–º')
    );
    
    let eventType = 'neutral';
    const rand = Math.random();
    
    if (isCooperativeChoice) {
        eventType = rand < 0.7 ? 'supportive' : rand < 0.9 ? 'neutral' : 'hostile';
    } else if (isAggressiveChoice) {
        eventType = rand < 0.6 ? 'hostile' : rand < 0.8 ? 'neutral' : 'supportive';
    } else {
        eventType = rand < 0.3 ? 'supportive' : rand < 0.7 ? 'neutral' : 'hostile';
    }
    
    const events = randomEvents[eventType];
    return events[Math.floor(Math.random() * events.length)];
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
function initializeScenarios() {
    gameState.usedScenarios = [];
    
    if (gameState.gameMode === 'normal') {
        gameState.availableScenarios = [...scenarios.static];
    } else {
        // –î–ª—è —Å–ª–æ–∂–Ω–æ–≥–æ –∏ —Å–ª–µ–ø–æ–≥–æ —Ä–µ–∂–∏–º–æ–≤
        const generalScenarios = scenarios.general || [];
        const countrySpecific = scenarios.country_specific[gameState.selectedCountry] || [];
        
        gameState.availableScenarios = [
            ...generalScenarios,
            ...countrySpecific
        ];
        
        // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏
        gameState.availableScenarios = shuffleArray(gameState.availableScenarios);
    }
}

function shuffleArray(array) {
    const shuffled = [...array];
    for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    return shuffled;
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è
function getNextScenario() {
    let scenario;
    
    if (gameState.gameMode === 'normal') {
        // –°—Ç–∞—Ç–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
        scenario = gameState.availableScenarios[gameState.currentTurn];
    } else {
        // –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
        const availableNow = gameState.availableScenarios.filter(
            s => !gameState.usedScenarios.includes(s.id)
        );
        
        if (availableNow.length === 0) {
            // –ï—Å–ª–∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å, –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –∑–∞–Ω–æ–≤–æ
            gameState.usedScenarios = [];
            scenario = gameState.availableScenarios[0];
        } else {
            scenario = availableNow[Math.floor(Math.random() * availableNow.length)];
        }
    }
    
    return scenario;
}

// –ü–∞—Å—Ö–∞–ª–∫–∞
function setupEasterEgg() {
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ü–ö (Ctrl + Shift + R, –∑–∞—Ç–µ–º "6tr0")
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.shiftKey && e.key === 'R') {
            e.preventDefault();
            keySequence = '';
            keySequenceActive = true;
            console.log('Easter egg sequence activated');
            
            clearTimeout(keySequenceTimer);
            keySequenceTimer = setTimeout(() => {
                keySequence = '';
                keySequenceActive = false;
            }, 5000);
            return;
        }
        
        if (keySequenceActive) {
            keySequence += e.key.toLowerCase();
            console.log('Key sequence:', keySequence);
            
            if (keySequence.includes('6tr0')) {
                showDragonEasterEgg();
                keySequence = '';
                keySequenceActive = false;
                clearTimeout(keySequenceTimer);
            }
        }
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (5 —Ç–∞–ø–æ–≤ –ø–æ –ª–æ–≥–æ + –¥–æ–ª–≥–∏–π —Ç–∞–ø)
    const logoSection = document.getElementById('logoSection');
    if (logoSection) {
        logoSection.addEventListener('click', handleLogoTap);
        logoSection.addEventListener('touchend', handleLogoTap);
        
        // –î–æ–ª–≥–∏–π —Ç–∞–ø
        let longTapTimer;
        
        logoSection.addEventListener('mousedown', function() {
            if (logoTapCount >= 5) {
                longTapTimer = setTimeout(() => {
                    showDragonEasterEgg();
                    logoTapCount = 0;
                }, 2000);
            }
        });
        
        logoSection.addEventListener('touchstart', function() {
            if (logoTapCount >= 5) {
                longTapTimer = setTimeout(() => {
                    showDragonEasterEgg();
                    logoTapCount = 0;
                }, 2000);
            }
        });
        
        logoSection.addEventListener('mouseup', function() {
            clearTimeout(longTapTimer);
        });
        
        logoSection.addEventListener('touchend', function() {
            clearTimeout(longTapTimer);
        });
    }
}

function handleLogoTap(e) {
    e.preventDefault();
    logoTapCount++;
    console.log('Logo tap count:', logoTapCount);
    
    clearTimeout(logoTapTimer);
    logoTapTimer = setTimeout(() => {
        logoTapCount = 0;
    }, 3000);
    
    if (logoTapCount >= 5) {
        logoTapCount = 5; // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞ 5
    }
}

function showDragonEasterEgg() {
    console.log('Showing dragon easter egg!');
    const dragon = document.getElementById('dragonEasterEgg');
    if (dragon) {
        dragon.classList.remove('hidden');
        setTimeout(() => {
            dragon.classList.add('hidden');
        }, 3000);
    }
}

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω
function renderCountries() {
    const countriesGrid = document.getElementById('countriesGrid');
    if (!countriesGrid) return;
    
    countriesGrid.innerHTML = '';
    
    Object.entries(gameData.countries).forEach(([code, country]) => {
        const countryCard = document.createElement('div');
        countryCard.className = 'country-card';
        countryCard.setAttribute('data-country', code);
        
        countryCard.innerHTML = `
            <div class="country-difficulty">${country.difficulty}</div>
            <div class="country-flag">${country.flag}</div>
            <div class="country-name">${country.name}</div>
            <div class="country-specialties">${country.specialties.join(', ')}</div>
            <div class="country-bonus">–ë–æ–Ω—É—Å: +${country.bonus} –±–∞–ª–ª–æ–≤</div>
        `;
        
        countryCard.addEventListener('click', function() {
            selectCountry(code);
        });
        
        countriesGrid.appendChild(countryCard);
    });
}

// –í—ã–±–æ—Ä —Å—Ç—Ä–∞–Ω—ã
function selectCountry(countryCode) {
    gameState.selectedCountry = countryCode;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º UI
    document.querySelectorAll('.country-card').forEach(card => {
        card.classList.remove('selected');
    });
    
    const selectedCard = document.querySelector(`[data-country="${countryCode}"]`);
    if (selectedCard) {
        selectedCard.classList.add('selected');
    }
    
    updateStartButton();
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ —Å—Ç–∞—Ä—Ç–∞
function updateStartButton() {
    const startBtn = document.getElementById('startBtn');
    const selectedCountry = gameState.selectedCountry;
    const selectedMode = document.querySelector('input[name="gameMode"]:checked')?.value;
    
    if (startBtn) {
        startBtn.disabled = !selectedCountry || !selectedMode;
        
        if (selectedCountry && selectedMode) {
            const country = gameData.countries[selectedCountry];
            startBtn.innerHTML = `<i class="fas fa-play"></i> –ù–∞—á–∞—Ç—å –∏–≥—Ä—É –∑–∞ ${country.name}`;
        } else {
            startBtn.innerHTML = `<i class="fas fa-play"></i> –ù–∞—á–∞—Ç—å –∏–≥—Ä—É`;
        }
    }
}

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
function setupEventListeners() {
    // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
    const themeToggle = document.getElementById('themeToggle');
    if (themeToggle) {
        themeToggle.addEventListener('click', toggleTheme);
    }
    
    // –†–∞–¥–∏–æ –∫–Ω–æ–ø–∫–∏ —Ä–µ–∂–∏–º–æ–≤ –∏–≥—Ä—ã
    document.querySelectorAll('input[name="gameMode"]').forEach(radio => {
        radio.addEventListener('change', function() {
            gameState.gameMode = this.value;
            updateStartButton();
        });
    });
    
    // –ö–Ω–æ–ø–∫–∞ —Å—Ç–∞—Ä—Ç–∞ –∏–≥—Ä—ã
    const startBtn = document.getElementById('startBtn');
    if (startBtn) {
        startBtn.addEventListener('click', startGame);
    }
    
    // –ö–Ω–æ–ø–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ö–æ–¥–∞
    const nextBtn = document.getElementById('nextTurnBtn');
    if (nextBtn) {
        nextBtn.addEventListener('click', nextTurn);
    }
    
    // –ö–Ω–æ–ø–∫–∞ –Ω–æ–≤–æ–π –∏–≥—Ä—ã
    const newGameBtn = document.getElementById('newGameBtn');
    if (newGameBtn) {
        newGameBtn.addEventListener('click', newGame);
    }
    
    // –ö–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ PDF
    const exportPdfBtn = document.getElementById('exportPdfBtn');
    if (exportPdfBtn) {
        exportPdfBtn.addEventListener('click', exportToPDF);
    }
}

// –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã
function startGame() {
    if (!gameState.selectedCountry || !gameState.gameMode) return;
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º –±–∞–∑–æ–≤—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã —Å—Ç—Ä–∞–Ω—ã
    const country = gameData.countries[gameState.selectedCountry];
    Object.entries(country.base_modifiers).forEach(([key, value]) => {
        gameState.economicState[key] += value;
    });
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏
    initializeScenarios();
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    gameState.currentTurn = 0;
    gameState.history = [];
    gameState.randomEvents = [];
    gameState.trust = 50;
    
    showScreen('game');
    loadScenario();
}

// –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è
function loadScenario() {
    const totalSteps = gameState.gameMode === 'normal' ? 
        gameData.stepsNormal : gameData.stepsAdvanced;
    
    if (gameState.currentTurn >= totalSteps) {
        showResults();
        return;
    }
    
    const scenario = getNextScenario();
    if (!scenario) {
        showResults();
        return;
    }
    
    gameState.currentScenario = scenario;
    gameState.usedScenarios.push(scenario.id);
    
    updateGameProgress();
    updateIndicators();
    renderScenario(scenario);
    updateCharts();
}

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
function showScreen(screenName) {
    document.querySelectorAll('.screen').forEach(screen => {
        screen.classList.remove('active');
    });
    
    const targetScreen = document.getElementById(`${screenName}Screen`);
    if (targetScreen) {
        targetScreen.classList.add('active');
    }
    
    gameState.currentScreen = screenName;
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏–≥—Ä—ã
function updateGameProgress() {
    const progressInfo = document.getElementById('progressInfo');
    const progressFill = document.getElementById('progressFill');
    const country = gameData.countries[gameState.selectedCountry];
    
    const totalSteps = gameState.gameMode === 'normal' ? 
        gameData.stepsNormal : gameData.stepsAdvanced;
    
    if (progressInfo) {
        progressInfo.innerHTML = `
            <div>
                <h1>${country.flag} ${country.name}</h1>
                <p>–†–µ–∂–∏–º: ${getModeDisplayName()}</p>
            </div>
            <div>
                <p>–•–æ–¥ ${gameState.currentTurn + 1} –∏–∑ ${totalSteps}</p>
                <p>–î–æ–≤–µ—Ä–∏–µ: ${Math.round(gameState.trust)}</p>
            </div>
        `;
    }
    
    if (progressFill) {
        const progress = ((gameState.currentTurn + 1) / totalSteps) * 100;
        progressFill.style.width = `${progress}%`;
    }
}

function getModeDisplayName() {
    const modes = {
        'normal': '–ù–æ—Ä–º–∞–ª—å–Ω—ã–π',
        'hard': '–°–ª–æ–∂–Ω—ã–π', 
        'blind': '–°–ª–µ–ø–æ–π'
    };
    return modes[gameState.gameMode] || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π';
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
function updateIndicators() {
    const indicators = [
        { id: 'gdpIndicator', key: 'gdpIdx', format: (v) => v.toFixed(1) },
        { id: 'expIndicator', key: 'expIdx', format: (v) => v.toFixed(1) },
        { id: 'impIndicator', key: 'impIdx', format: (v) => v.toFixed(1) },
        { id: 'cpiIndicator', key: 'cpi', format: (v) => v.toFixed(1) + '%' },
        { id: 'unemploymentIndicator', key: 'unemployment', format: (v) => v.toFixed(1) + '%' }
    ];
    
    indicators.forEach(({ id, key, format }) => {
        const element = document.getElementById(id);
        if (element) {
            const value = gameState.economicState[key];
            const baseValue = gameData.baseState[key];
            const change = value - baseValue;
            
            element.querySelector('.value').textContent = format(value);
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å –∏–∑–º–µ–Ω–µ–Ω–∏—è
            let changeClass = 'neutral';
            if (key === 'cpi' || key === 'unemployment') {
                changeClass = change < -0.1 ? 'positive' : change > 0.1 ? 'negative' : 'neutral';
            } else {
                changeClass = change > 0.1 ? 'positive' : change < -0.1 ? 'negative' : 'neutral';
            }
            
            element.className = `indicator ${changeClass}`;
        }
    });
}

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è
function renderScenario(scenario) {
    const scenarioHeader = document.getElementById('scenarioHeader');
    const scenarioText = document.getElementById('scenarioText');
    const choicesContainer = document.getElementById('choicesContainer');
    
    if (scenarioHeader) {
        scenarioHeader.textContent = `–°—Ü–µ–Ω–∞—Ä–∏–π ${gameState.currentTurn + 1}`;
    }
    
    if (scenarioText) {
        scenarioText.textContent = scenario.text;
    }
    
    if (choicesContainer) {
        choicesContainer.innerHTML = '';
        
        scenario.choices.forEach(choice => {
            const choiceCard = document.createElement('div');
            choiceCard.className = 'choice-card';
            choiceCard.setAttribute('data-choice', choice.id);
            
            choiceCard.innerHTML = `
                <div class="choice-header">
                    <i class="${choice.icon}"></i>
                    <h3>${choice.label}</h3>
                </div>
                <p class="choice-hint">${choice.hint}</p>
            `;
            
            choiceCard.addEventListener('click', function() {
                selectChoice(choice);
            });
            
            choicesContainer.appendChild(choiceCard);
        });
    }
    
    // –°–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –ø—Ä–∏ –Ω–æ–≤–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏
    document.getElementById('effectsPanel').style.display = 'none';
}

// –í—ã–±–æ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–∞ –¥–µ–π—Å—Ç–≤–∏–π
function selectChoice(choice) {
    console.log('–í—ã–±—Ä–∞–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ:', choice.label);
    
    document.querySelectorAll('.choice-card').forEach(card => {
        card.classList.remove('selected');
    });
    
    const selectedCard = document.querySelector(`[data-choice="${choice.id}"]`);
    if (selectedCard) {
        selectedCard.classList.add('selected');
    }
    
    gameState.selectedChoice = choice;
    showEffects(choice);
}

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
function showEffects(choice) {
    const effectsPanel = document.getElementById('effectsPanel');
    const effectsGrid = document.getElementById('effectsGrid');
    const economicTheoryText = document.getElementById('economicTheoryText');
    const historicalText = document.getElementById('historicalText');
    const nextBtn = document.getElementById('nextTurnBtn');
    
    effectsGrid.innerHTML = '';
    
    if (gameState.gameMode !== 'blind') {
        const effects = gameState.gameMode === 'hard' ? 
            multiplyEffects(choice.effect, 1.5) : choice.effect;
        
        const labels = {
            gdp: '–í–í–ü',
            exp: '–≠–∫—Å–ø–æ—Ä—Ç', 
            imp: '–ò–º–ø–æ—Ä—Ç',
            cpi: '–ò–Ω—Ñ–ª—è—Ü–∏—è',
            unemployment: '–ë–µ–∑—Ä–∞–±–æ—Ç–∏—Ü–∞'
        };
        
        Object.entries(effects).forEach(([key, value]) => {
            const effectItem = document.createElement('div');
            effectItem.className = `effect-item ${value > 0 ? 'positive' : value < 0 ? 'negative' : 'neutral'}`;
            
            const sign = value > 0 ? '+' : '';
            const suffix = ['cpi', 'unemployment'].includes(key) ? '%' : '';
            
            effectItem.innerHTML = `
                <div>${labels[key]}</div>
                <div>${sign}${value.toFixed(1)}${suffix}</div>
            `;
            
            effectsGrid.appendChild(effectItem);
        });
    }
    
    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫—É—é —Ç–µ–æ—Ä–∏—é –∏ –∏—Å—Ç–æ—Ä–∏—é
    if (economicTheoryText && choice.economicTheory) {
        economicTheoryText.textContent = choice.economicTheory;
        economicTheoryText.parentElement.style.display = 'block';
    } else if (economicTheoryText) {
        economicTheoryText.parentElement.style.display = 'none';
    }
    
    if (historicalText && choice.history) {
        historicalText.textContent = choice.history;
        historicalText.parentElement.style.display = 'block';
    } else if (historicalText) {
        historicalText.parentElement.style.display = 'none';
    }
    
    effectsPanel.style.display = 'block';
    nextBtn.disabled = false;
}

// –£–º–Ω–æ–∂–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ (–¥–ª—è —Å–ª–æ–∂–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞)
function multiplyEffects(effects, multiplier) {
    const result = {};
    Object.entries(effects).forEach(([key, value]) => {
        result[key] = value * multiplier;
    });
    return result;
}

// –°–ª–µ–¥—É—é—â–∏–π —Ö–æ–¥
function nextTurn() {
    if (!gameState.selectedChoice) return;
    
    const choice = gameState.selectedChoice;
    const effects = gameState.gameMode === 'hard' ? 
        multiplyEffects(choice.effect, 1.5) : choice.effect;
    
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
    const randomEvent = generateRandomEvent(choice, gameState.currentScenario.tags);
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
    Object.entries(effects).forEach(([key, value]) => {
        gameState.economicState[key] += value;
    });
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
    Object.entries(randomEvent.effect).forEach(([key, value]) => {
        gameState.economicState[key] += value;
    });
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ–≤–µ—Ä–∏–µ
    updateTrust(choice);
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏–∏
    gameState.history.push({
        turn: gameState.currentTurn + 1,
        scenario: gameState.currentScenario.text,
        choice: choice.label,
        effects: effects,
        randomEvent: randomEvent,
        state: { ...gameState.economicState },
        trust: gameState.trust
    });
    
    gameState.randomEvents.push(randomEvent);
    
    // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ö–æ–¥—É
    gameState.currentTurn++;
    gameState.selectedChoice = null;
    
    loadScenario();
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–≤–µ—Ä–∏—è
function updateTrust(choice) {
    if (!choice.tags) return;
    
    let trustChange = 0;
    choice.tags.forEach(tag => {
        if (gameData.trustWeights[tag]) {
            trustChange += gameData.trustWeights[tag];
        }
    });
    
    gameState.trust = Math.max(0, Math.min(100, gameState.trust + trustChange));
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤
function updateCharts() {
    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–¥ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
    // –ü–æ–∫–∞ –æ—Å—Ç–∞–≤–∏–º –∑–∞–≥–ª—É—à–∫—É
}

// –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
function showResults() {
    calculateFinalScore();
    showScreen('results');
    renderResults();
    createFinalChart();
}

// –†–∞—Å—á–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å—á–µ—Ç–∞
function calculateFinalScore() {
    const country = gameData.countries[gameState.selectedCountry];
    const state = gameState.economicState;
    const base = gameData.baseState;
    
    // –í—ã—á–∏—Å–ª—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
    gameState.changes = {
        gdp: state.gdpIdx - base.gdpIdx,
        exp: state.expIdx - base.expIdx,
        imp: state.impIdx - base.impIdx,
        cpi: state.cpi - base.cpi,
        unemployment: state.unemployment - base.unemployment
    };
    
    // –ë–∞–∑–æ–≤—ã–µ –æ—á–∫–∏ (0-60)
    let baseScore = 30; // –°—Ç–∞—Ä—Ç–æ–≤—ã–µ –æ—á–∫–∏
    baseScore += Math.max(-15, Math.min(15, gameState.changes.gdp * 1.5));
    baseScore += Math.max(-10, Math.min(10, gameState.changes.exp * 1.0));
    baseScore += Math.max(-10, Math.min(10, -gameState.changes.cpi * 5));
    baseScore += Math.max(-10, Math.min(10, -gameState.changes.unemployment * 2));
    
    // –ë–æ–Ω—É—Å –∑–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞–Ω—ã (0-15)
    const countryBonus = country.bonus;
    
    // –ë–æ–Ω—É—Å –∑–∞ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–µ—à–µ–Ω–∏–π (0-20)
    const avgTrustChange = gameState.history.reduce((sum, turn) => {
        return sum + (turn.trust - 50);
    }, 0) / Math.max(1, gameState.history.length);
    const performanceBonus = Math.max(0, Math.min(20, avgTrustChange * 0.4 + 10));
    
    // –ë–æ–Ω—É—Å –∑–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (0-5)
    const consistencyBonus = gameState.trust > 40 ? 5 : gameState.trust > 20 ? 3 : 0;
    
    gameState.finalScore = Math.max(0, Math.min(100, baseScore + countryBonus + performanceBonus + consistencyBonus));
    
    gameState.scoreBreakdown = {
        baseScore: Math.round(baseScore),
        countryBonus: countryBonus,
        performanceBonus: Math.round(performanceBonus),
        consistencyBonus: consistencyBonus
    };
}

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
function renderResults() {
    updateResultsHeader();
    updateFinalIndicators();
    updateFinalScore();
    updateTrustAnalysis();
    generateDetailedAnalysis();
    generateGameLog();
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
function updateResultsHeader() {
    const country = gameData.countries[gameState.selectedCountry];
    const selectedCountryDisplay = document.getElementById('selectedCountryDisplay');
    const analysisTitle = document.getElementById('analysisTitle');
    
    if (selectedCountryDisplay) {
        selectedCountryDisplay.innerHTML = `
            <div class="results-country-flag">${country.flag}</div>
            <div>
                <h2>${country.name}</h2>
                <p>–†–µ–∂–∏–º: ${getModeDisplayName()}</p>
            </div>
        `;
    }
    
    if (analysisTitle) {
        analysisTitle.innerHTML = `
            <div class="analysis-country-flag">${country.flag}</div>
            <h2>–ê–Ω–∞–ª–∏–∑ –≤–∞—à–µ–π —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∑–∞ ${country.name}</h2>
        `;
    }
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
function updateFinalIndicators() {
    const finalIndicatorsGrid = document.getElementById('finalIndicatorsGrid');
    if (!finalIndicatorsGrid) return;
    
    const indicators = [
        {
            icon: 'fa-solid fa-chart-line',
            label: '–í–í–ü –∏–Ω–¥–µ–∫—Å',
            key: 'gdpIdx',
            suffix: '',
            inverse: false
        },
        {
            icon: 'fa-solid fa-arrow-up-right-from-square', 
            label: '–≠–∫—Å–ø–æ—Ä—Ç –∏–Ω–¥–µ–∫—Å',
            key: 'expIdx',
            suffix: '',
            inverse: false
        },
        {
            icon: 'fa-solid fa-arrow-down-right-to-square',
            label: '–ò–º–ø–æ—Ä—Ç –∏–Ω–¥–µ–∫—Å', 
            key: 'impIdx',
            suffix: '',
            inverse: false
        },
        {
            icon: 'fa-solid fa-percentage',
            label: '–ò–Ω—Ñ–ª—è—Ü–∏—è',
            key: 'cpi',
            suffix: '%',
            inverse: true
        },
        {
            icon: 'fa-solid fa-users',
            label: '–ë–µ–∑—Ä–∞–±–æ—Ç–∏—Ü–∞',
            key: 'unemployment', 
            suffix: '%',
            inverse: true
        }
    ];
    
    finalIndicatorsGrid.innerHTML = '';
    
    indicators.forEach(({ icon, label, key, suffix, inverse }) => {
        const finalValue = gameState.economicState[key];
        const baseValue = gameData.baseState[key];
        const change = finalValue - baseValue;
        
        const resultCard = document.createElement('div');
        resultCard.className = 'result-card';
        
        resultCard.innerHTML = `
            <i class="${icon}"></i>
            <h3>${label}</h3>
            <div class="result-values">
                <div class="final-value">${finalValue.toFixed(1)}${suffix}</div>
                <div class="change-value ${getChangeClass(change, inverse)}">
                    ${formatChange(change, suffix)}
                </div>
            </div>
        `;
        
        finalIndicatorsGrid.appendChild(resultCard);
    });
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å—á–µ—Ç–∞
function updateFinalScore() {
    const finalScoreCard = document.getElementById('finalScoreCard');
    if (!finalScoreCard) return;
    
    const score = gameState.finalScore;
    let scoreClass = 'poor';
    
    if (score >= 80) scoreClass = 'excellent';
    else if (score >= 60) scoreClass = 'good';  
    else if (score >= 40) scoreClass = 'average';
    
    finalScoreCard.className = `score-card ${scoreClass}`;
    
    const scoreValue = finalScoreCard.querySelector('.score-value');
    const scoreDescription = finalScoreCard.querySelector('.score-description');
    const scoreBreakdown = finalScoreCard.querySelector('.score-breakdown');
    
    if (scoreValue) {
        scoreValue.textContent = `${score}/100`;
    }
    
    if (scoreDescription) {
        scoreDescription.textContent = getScoreDescription();
    }
    
    if (scoreBreakdown) {
        const breakdown = gameState.scoreBreakdown;
        scoreBreakdown.innerHTML = `
            <strong>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ü–µ–Ω–∫–∏:</strong><br>
            ‚Ä¢ –ë–∞–∑–æ–≤—ã–µ –æ—á–∫–∏: ${breakdown.baseScore}/60<br>
            ‚Ä¢ –ë–æ–Ω—É—Å –∑–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—å: ${breakdown.countryBonus}/15<br>
            ‚Ä¢ –ö–∞—á–µ—Å—Ç–≤–æ —Ä–µ—à–µ–Ω–∏–π: ${breakdown.performanceBonus}/20<br>
            ‚Ä¢ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ${breakdown.consistencyBonus}/5
        `;
    }
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–≤–µ—Ä–∏—è
function updateTrustAnalysis() {
    const trustValue = document.getElementById('trustValue');
    const trustExplanation = document.getElementById('trustExplanation');
    
    if (trustValue) {
        trustValue.textContent = Math.round(gameState.trust);
    }
    
    if (trustExplanation) {
        trustExplanation.textContent = getTrustExplanation();
    }
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
function generateDetailedAnalysis() {
    const analysisContent = document.getElementById('analysisContent');
    if (!analysisContent) return;
    
    analysisContent.innerHTML = '';
    
    // –ê–Ω–∞–ª–∏–∑ —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏
    const tradeSection = document.createElement('div');
    tradeSection.className = 'analysis-section';
    tradeSection.innerHTML = `
        <h4><i class="fas fa-handshake"></i> –¢–æ—Ä–≥–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞</h4>
        <p>${analyzeTradePolicies()}</p>
    `;
    analysisContent.appendChild(tradeSection);
    
    // –ê–Ω–∞–ª–∏–∑ –¥–∏–ø–ª–æ–º–∞—Ç–∏–∏
    const diplomacySection = document.createElement('div'); 
    diplomacySection.className = 'analysis-section';
    diplomacySection.innerHTML = `
        <h4><i class="fas fa-globe"></i> –î–∏–ø–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è</h4>
        <p>${analyzeDiplomacy()}</p>
    `;
    analysisContent.appendChild(diplomacySection);
    
    // –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã
    const strengthsSection = document.createElement('div');
    strengthsSection.className = 'analysis-section strengths';
    strengthsSection.innerHTML = `
        <h4><i class="fas fa-thumbs-up"></i> –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã</h4>
        <p>${analyzeStrengths()}</p>
    `;
    analysisContent.appendChild(strengthsSection);
    
    // –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã
    const weaknessesSection = document.createElement('div');
    weaknessesSection.className = 'analysis-section weaknesses';
    weaknessesSection.innerHTML = `
        <h4><i class="fas fa-exclamation-triangle"></i> –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã</h4>
        <p>${analyzeWeaknesses()}</p>
    `;
    analysisContent.appendChild(weaknessesSection);
    
    // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
    const recommendationsSection = document.createElement('div');
    recommendationsSection.className = 'analysis-section recommendations';
    recommendationsSection.innerHTML = `
        <h4><i class="fas fa-lightbulb"></i> –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h4>
        <p>${generateRecommendations()}</p>
    `;
    analysisContent.appendChild(recommendationsSection);
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–æ–≥–∞ —Ö–æ–¥–æ–≤
function generateGameLog() {
    const gameLogContent = document.getElementById('gameLogContent');
    if (!gameLogContent) return;
    
    gameLogContent.innerHTML = '';
    
    gameState.history.forEach((turn, index) => {
        const logEntry = document.createElement('div');
        logEntry.className = 'log-entry';
        
        logEntry.innerHTML = `
            <div class="log-turn">
                <h4>–•–æ–¥ ${turn.turn}</h4>
                <div class="log-scenario">${turn.scenario}</div>
            </div>
            <div class="log-choice">
                <strong>–í—ã–±—Ä–∞–Ω–æ:</strong> ${turn.choice}
            </div>
            <div class="log-random-event">
                <strong>–°–ª—É—á–∞–π–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ:</strong> ${turn.randomEvent.text}
            </div>
            <div class="log-effects">
                <strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> 
                –í–í–ü ${formatChange(turn.effects.gdp)}, 
                –≠–∫—Å–ø–æ—Ä—Ç ${formatChange(turn.effects.exp)}, 
                –ò–º–ø–æ—Ä—Ç ${formatChange(turn.effects.imp)}, 
                –ò–Ω—Ñ–ª—è—Ü–∏—è ${formatChange(turn.effects.cpi, '%')}, 
                –ë–µ–∑—Ä–∞–±–æ—Ç–∏—Ü–∞ ${formatChange(turn.effects.unemployment, '%')}
            </div>
        `;
        
        gameLogContent.appendChild(logEntry);
    });
}

// –§—É–Ω–∫—Ü–∏–∏ –∞–Ω–∞–ª–∏–∑–∞ (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏)
function analyzeTradePolicies() {
    const history = gameState.history;
    let protectionistMoves = 0;
    let opennessMoves = 0;
    
    history.forEach(turn => {
        if (turn.choice.toLowerCase().includes('—Ç–∞—Ä–∏—Ñ') || 
            turn.choice.toLowerCase().includes('–ø–æ—à–ª–∏–Ω') || 
            turn.choice.toLowerCase().includes('–∑–∞—â–∏—Ç')) {
            protectionistMoves++;
        }
        if (turn.choice.toLowerCase().includes('–ø–µ—Ä–µ–≥–æ–≤') || 
            turn.choice.toLowerCase().includes('—Å–æ—Ç—Ä—É–¥') || 
            turn.choice.toLowerCase().includes('–æ—Ç–∫—Ä')) {
            opennessMoves++;
        }
    });
    
    if (protectionistMoves > opennessMoves) {
        return `–í—ã –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–ª–∏—Å—å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –ø—Ä–æ—Ç–µ–∫—Ü–∏–æ–Ω–∏—Å—Ç—Å–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ (${protectionistMoves} –∑–∞—â–∏—Ç–Ω—ã—Ö –º–µ—Ä –ø—Ä–æ—Ç–∏–≤ ${opennessMoves} –æ—Ç–∫—Ä—ã—Ç—ã—Ö). –≠—Ç–æ –∑–∞—â–∏—Ç–∏–ª–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—Ç—Ä–∞—Å–ª–∏, –Ω–æ –º–æ–≥–ª–æ —Å–Ω–∏–∑–∏—Ç—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —ç–∫–æ–Ω–æ–º–∏–∫–∏ –∏ –≤—ã–∑–≤–∞—Ç—å —Ç–æ—Ä–≥–æ–≤—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã.`;
    } else if (opennessMoves > protectionistMoves) {
        return `–í–∞—à–∞ —Ç–æ—Ä–≥–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –±—ã–ª–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ (${opennessMoves} –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ä–µ—à–µ–Ω–∏–π –ø—Ä–æ—Ç–∏–≤ ${protectionistMoves} –∑–∞—â–∏—Ç–Ω—ã—Ö). –≠—Ç–æ —Å–ø–æ—Å–æ–±—Å—Ç–≤–æ–≤–∞–ª–æ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏, –Ω–æ –º–æ–≥–ª–æ —Å–æ–∑–¥–∞—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç—å –¥–ª—è –æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π.`;
    } else {
        return `–í—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–ª–∏—Ç–∏–∫–µ, –∫–æ–º–±–∏–Ω–∏—Ä—É—è –∑–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ä—ã —Å –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å—é –∫ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤—É. –≠—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π.`;
    }
}

function analyzeDiplomacy() {
    const trustLevel = gameState.trust;
    const history = gameState.history;
    let cooperativeMoves = history.filter(turn => 
        turn.choice.toLowerCase().includes('–ø–µ—Ä–µ–≥–æ–≤') || 
        turn.choice.toLowerCase().includes('—Å–æ—Ç—Ä—É–¥') || 
        turn.choice.toLowerCase().includes('–∫–æ–º–ø—Ä–æ–º–∏—Å—Å')
    ).length;
    
    if (trustLevel >= 70) {
        return `–û—Ç–ª–∏—á–Ω–∞—è –¥–∏–ø–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞! –£—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è ${trustLevel} —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É–µ—Ç –æ —Ç–æ–º, —á—Ç–æ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤–∞—Å –∫–∞–∫ –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞. –í–∞—à–∏ ${cooperativeMoves} –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏—è —Å–ø–æ—Å–æ–±—Å—Ç–≤–æ–≤–∞–ª–∏ —É–∫—Ä–µ–ø–ª–µ–Ω–∏—é –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π.`;
    } else if (trustLevel >= 50) {
        return `–£–º–µ—Ä–µ–Ω–Ω–æ —É—Å–ø–µ—à–Ω–∞—è –¥–∏–ø–ª–æ–º–∞—Ç–∏—è. –£—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è ${trustLevel} –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø–∞—Ä—Ç–Ω–µ—Ä—ã –≤ —Ü–µ–ª–æ–º –≥–æ—Ç–æ–≤—ã –∫ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤—É, –Ω–æ –µ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –æ–ø–∞—Å–µ–Ω–∏—è –ø–æ –ø–æ–≤–æ–¥—É –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≤–∞—à–∏—Ö —Ä–µ—à–µ–Ω–∏–π. –ë–æ–ª—å—à–µ –≤–Ω–∏–º–∞–Ω–∏—è –∫ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–∞–º –º–æ–≥–ª–æ –±—ã —É–ª—É—á—à–∏—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏—è.`;
    } else {
        return `–ü—Ä–æ–±–ª–µ–º—ã –≤ –¥–∏–ø–ª–æ–º–∞—Ç–∏–∏. –ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è (${trustLevel}) —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ –º–Ω–æ–≥–∏–µ –≤–∞—à–∏ —Ä–µ—à–µ–Ω–∏—è –±—ã–ª–∏ –≤–æ—Å–ø—Ä–∏–Ω—è—Ç—ã –∫–∞–∫ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –∏–ª–∏ –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ. –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞—Ç—Ä—É–¥–Ω–∏—Ç—å –±—É–¥—É—â–µ–µ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ –∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∏–∑–æ–ª—è—Ü–∏–∏.`;
    }
}

function analyzeStrengths() {
    const changes = gameState.changes;
    const strengths = [];
    
    if (changes.gdp > 5) {
        strengths.push('—É—Å–ø–µ—à–Ω–æ–µ —Å—Ç–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–≥–æ —Ä–æ—Å—Ç–∞');
    }
    if (changes.exp > 10) {
        strengths.push('–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞');
    }
    if (changes.unemployment < -2) {
        strengths.push('—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –±–µ–∑—Ä–∞–±–æ—Ç–∏—Ü—ã');
    }
    if (changes.cpi < 1 && changes.cpi > -1) {
        strengths.push('–ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –∏–Ω—Ñ–ª—è—Ü–∏–∏');
    }
    if (gameState.trust > 60) {
        strengths.push('—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ–≤–µ—Ä–∏—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤');
    }
    
    if (strengths.length === 0) {
        return '–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —è–≤–Ω—ã—Ö —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω –≤—ã—è–≤–∏—Ç—å –Ω–µ —É–¥–∞–ª–æ—Å—å. –≠—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–∞ –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π –ø–æ–ª–∏—Ç–∏–∫–µ.';
    }
    
    return `–í–∞—à–∏ –≥–ª–∞–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è: ${strengths.join(', ')}. –≠—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –º–∞–∫—Ä–æ—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.`;
}

function analyzeWeaknesses() {
    const changes = gameState.changes;
    const weaknesses = [];
    
    if (changes.gdp < -3) {
        weaknesses.push('—Å–µ—Ä—å–µ–∑–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ –í–í–ü —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏');
    }
    if (changes.unemployment > 3) {
        weaknesses.push('—Ä–æ—Å—Ç –±–µ–∑—Ä–∞–±–æ—Ç–∏—Ü—ã —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É–µ—Ç –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö –Ω–∞ —Ä—ã–Ω–∫–µ —Ç—Ä—É–¥–∞');
    }
    if (changes.cpi > 3) {
        weaknesses.push('–≤—ã—Å–æ–∫–∞—è –∏–Ω—Ñ–ª—è—Ü–∏—è –ø–æ–¥—Ä—ã–≤–∞–µ—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª—å–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –Ω–∞—Å–µ–ª–µ–Ω–∏—è');
    }
    if (gameState.trust < 40) {
        weaknesses.push('–ø–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞');
    }
    
    // –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ—á–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π
    const problematicDecisions = gameState.history.filter(turn => {
        const effects = turn.effects;
        return (effects.gdp < -1 && effects.unemployment > 1) || 
               (effects.cpi > 1 && effects.gdp < 0);
    });
    
    if (problematicDecisions.length > 0) {
        weaknesses.push(`${problematicDecisions.length} —Ä–µ—à–µ–Ω–∏–π –ø—Ä–∏–≤–µ–ª–∏ –∫ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º—É —É—Ö—É–¥—à–µ–Ω–∏—é –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π`);
    }
    
    if (weaknesses.length === 0) {
        return '–°–µ—Ä—å–µ–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –æ—à–∏–±–æ–∫ –Ω–µ –≤—ã—è–≤–ª–µ–Ω–æ, –Ω–æ –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å –º–µ—Å—Ç–æ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏–π –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏.';
    }
    
    return `–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã: ${weaknesses.join('; ')}. –≠—Ç–∏ –æ—à–∏–±–∫–∏ —á–∞—Å—Ç–æ —Å–≤—è–∑–∞–Ω—ã —Å –Ω–µ–¥–æ–æ—Ü–µ–Ω–∫–æ–π –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π.`;
}

function generateRecommendations() {
    const changes = gameState.changes;
    const recommendations = [];
    
    if (changes.gdp < 0) {
        recommendations.push('—Ñ–æ–∫—É—Å –Ω–∞ —Å—Ç–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–≥–æ —Ä–æ—Å—Ç–∞ —á–µ—Ä–µ–∑ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏–∏');
    }
    if (changes.unemployment > 2) {
        recommendations.push('–∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏, –≤–∫–ª—é—á–∞—è –ø–µ—Ä–µ–∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É –º–∞–ª–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞');
    }
    if (changes.cpi > 2) {
        recommendations.push('–±–æ–ª–µ–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω–∞—è —Ñ–∏—Å–∫–∞–ª—å–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∏–Ω—Ñ–ª—è—Ü–∏–æ–Ω–Ω–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è');
    }
    if (gameState.trust < 50) {
        recommendations.push('–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–∞–º –∏ –º–Ω–æ–≥–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–º—É —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤—É –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ–≤–µ—Ä–∏—è');
    }
    
    recommendations.push('–±–æ–ª–µ–µ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ–µ –∏–∑—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –∏ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π —Ç–µ–æ—Ä–∏–∏ –ø—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ —Ä–µ—à–µ–Ω–∏–π');
    recommendations.push('—É—á–µ—Ç –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π –ø—Ä–∏ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–º –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏');
    
    return `–í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: ${recommendations.join('; ')}. –ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ —Ç—Ä–µ–±—É–µ—Ç –±–∞–ª–∞–Ω—Å–∞ –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ü–µ–ª—è–º–∏ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º–∏.`;
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
function formatChange(value, suffix = '') {
    const sign = value > 0 ? '+' : '';
    return `${sign}${value.toFixed(1)}${suffix}`;
}

function getChangeClass(value, inverse = false) {
    if (Math.abs(value) < 0.1) return 'neutral';
    if (inverse) {
        return value < 0 ? 'positive' : 'negative';
    } else {
        return value > 0 ? 'positive' : 'negative';
    }
}

function getTrustExplanation() {
    const trust = gameState.trust;
    if (trust >= 80) {
        return "–û—Ç–ª–∏—á–Ω–æ–µ –¥–æ–≤–µ—Ä–∏–µ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞. –í–∞—à–∞ –ø–æ–ª–∏—Ç–∏–∫–∞ –±—ã–ª–∞ –≤–∑–≤–µ—à–µ–Ω–Ω–æ–π –∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–π, —á—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –±—É–¥—É—â–∏—Ö —Ç–æ—Ä–≥–æ–≤–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö —Å–æ–≥–ª–∞—à–µ–Ω–∏–π.";
    } else if (trust >= 60) {
        return "–•–æ—Ä–æ—à–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è. –í —Ü–µ–ª–æ–º –≤–∞—à–∏ —Ä–µ—à–µ–Ω–∏—è –±—ã–ª–∏ —Ä–∞–∑—É–º–Ω—ã–º–∏ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º–∏, —Ö–æ—Ç—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –≤—ã–∑–≤–∞–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –æ–ø–∞—Å–µ–Ω–∏—è —É —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤.";
    } else if (trust >= 40) {
        return "–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ—à–µ–Ω–∏—è –±—ã–ª–∏ –≤–æ—Å–ø—Ä–∏–Ω—è—Ç—ã –∫–∞–∫ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –∏–ª–∏ –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ, —á—Ç–æ –º–æ–∂–µ—Ç –æ—Å–ª–æ–∂–Ω–∏—Ç—å –±—É–¥—É—â–∏–µ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã –∏ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ.";
    } else if (trust >= 20) {
        return "–ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è. –ú–Ω–æ–≥–∏–µ —Ä–µ—à–µ–Ω–∏—è –±—ã–ª–∏ –≤–æ—Å–ø—Ä–∏–Ω—è—Ç—ã –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–º —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ, —á—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ –ø–æ–¥—Ä—ã–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –≤–∑–∞–∏–º–æ–≤—ã–≥–æ–¥–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞.";
    } else {
        return "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–∏–∑–∫–æ–µ –¥–æ–≤–µ—Ä–∏–µ. –í–∞—à–∞ –ø–æ–ª–∏—Ç–∏–∫–∞ —Å–µ—Ä—å–µ–∑–Ω–æ –ø–æ–¥–æ—Ä–≤–∞–ª–∞ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∏–∑–æ–ª—è—Ü–∏–∏ –∏ –æ—Ç–≤–µ—Ç–Ω—ã–º —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–º –º–µ—Ä–∞–º.";
    }
}

function getScoreDescription() {
    const score = gameState.finalScore;
    if (score >= 80) {
        return "–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ! –í—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç–µ –≥–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏ –º–∞–∫—Ä–æ—ç–∫–æ–Ω–æ–º–∏–∫–∏.";
    } else if (score >= 60) {
        return "–•–æ—Ä–æ—à–æ! –í–∞—à–∞ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–∫–∞–∑–∞–ª–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.";
    } else if (score >= 40) {
        return "–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ. –ï—Å—Ç—å –∫–∞–∫ —É—Å–ø–µ—Ö–∏, —Ç–∞–∫ –∏ –æ–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è.";
    } else if (score >= 20) {
        return "–ù–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤.";
    } else {
        return "–ö—Ä–∏—Ç–∏—á–Ω–æ! –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–∑—É—á–∏—Ç—å –æ—Å–Ω–æ–≤—ã —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π —Ç–µ–æ—Ä–∏–∏ –∏ —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏.";
    }
}

// –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞
function createFinalChart() {
    const canvas = document.getElementById('finalChart');
    if (!canvas) return;
    
    const ctx = canvas.getContext('2d');
    
    const labels = ['–°—Ç–∞—Ä—Ç'];
    gameState.history.forEach((_, index) => {
        labels.push(`–•–æ–¥ ${index + 1}`);
    });
    
    const gdpData = [gameData.baseState.gdpIdx];
    const expData = [gameData.baseState.expIdx];
    const impData = [gameData.baseState.impIdx];
    
    gameState.history.forEach(h => {
        gdpData.push(h.state.gdpIdx);
        expData.push(h.state.expIdx);
        impData.push(h.state.impIdx);
    });
    
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [
                {
                    label: '–í–í–ü –∏–Ω–¥–µ–∫—Å',
                    data: gdpData,
                    borderColor: '#1FB8CD',
                    backgroundColor: '#1FB8CD20',
                    borderWidth: 2,
                    tension: 0.1
                },
                {
                    label: '–≠–∫—Å–ø–æ—Ä—Ç –∏–Ω–¥–µ–∫—Å',
                    data: expData,
                    borderColor: '#FFC185',
                    backgroundColor: '#FFC18520',
                    borderWidth: 2,
                    tension: 0.1
                },
                {
                    label: '–ò–º–ø–æ—Ä—Ç –∏–Ω–¥–µ–∫—Å',
                    data: impData,
                    borderColor: '#B4413C',
                    backgroundColor: '#B4413C20',
                    borderWidth: 2,
                    tension: 0.1
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'top'
                }
            },
            scales: {
                y: {
                    beginAtZero: false,
                    grid: {
                        color: getComputedStyle(document.documentElement).getPropertyValue('--color-card-border').trim()
                    },
                    ticks: {
                        color: getComputedStyle(document.documentElement).getPropertyValue('--color-text-secondary').trim()
                    }
                },
                x: {
                    grid: {
                        color: getComputedStyle(document.documentElement).getPropertyValue('--color-card-border').trim()
                    },
                    ticks: {
                        color: getComputedStyle(document.documentElement).getPropertyValue('--color-text-secondary').trim()
                    }
                }
            }
        }
    });
}

// –ù–æ–≤–∞—è –∏–≥—Ä–∞
function newGame() {
    // –£–Ω–∏—á—Ç–æ–∂–∞–µ–º —Å—Ç–∞—Ä—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏
    Object.values(gameState.charts).forEach(chart => {
        if (chart && chart.destroy) {
            chart.destroy();
        }
    });
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
    gameState = {
        currentScreen: 'start',
        selectedCountry: null,
        gameMode: 'normal',
        currentTurn: 0,
        currentScenario: null,
        selectedChoice: null,
        economicState: { ...gameData.baseState },
        trust: 50,
        history: [],
        randomEvents: [],
        charts: {},
        usedScenarios: [],
        availableScenarios: [],
        theme: gameState.theme // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–º—É
    };
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º UI
    document.querySelectorAll('.country-card').forEach(card => {
        card.classList.remove('selected');
    });
    
    document.querySelectorAll('input[name="gameMode"]').forEach(radio => {
        radio.checked = radio.value === 'normal';
    });
    
    updateStartButton();
    showScreen('start');
}

// –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF
function exportToPDF() {
    const studentName = document.getElementById('studentName').value.trim();
    const studentGroup = document.getElementById('studentGroup').value.trim();
    
    if (!studentName || !studentGroup) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –§–ò–û –∏ –≥—Ä—É–ø–ø—É –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ PDF');
        return;
    }
    
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à—Ä–∏—Ñ—Ç–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞  
    doc.setFont('helvetica');
    
    const country = gameData.countries[gameState.selectedCountry];
    const state = gameState.economicState;
    
    // –ó–∞–≥–æ–ª–æ–≤–æ–∫
    doc.setFontSize(16);
    doc.text('OTCHET PO SIMULYACII "TORGOVYE VOJNY"', 105, 20, { align: 'center' });
    
    // –§–ò–û –∏ –≥—Ä—É–ø–ø–∞
    doc.setFontSize(12);
    doc.text(`FIO: ${studentName}`, 20, 35);
    doc.text(`Gruppa: ${studentGroup}`, 20, 45);
    doc.text(`Data: ${new Date().toLocaleDateString('ru-RU')}`, 20, 55);
    doc.text(`Versiya: ${GAME_VERSION}`, 20, 65);
    
    // –í—ã–±—Ä–∞–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∞
    doc.setFontSize(14);
    doc.text(`Strana: ${country.name}`, 20, 80);
    doc.setFontSize(10);
    doc.text(`Slozhnost': ${country.difficulty} (+${country.bonus} ballov)`, 20, 90);
    doc.text(`Rezhim: ${getModeDisplayName()}`, 20, 100);
    
    // –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞
    doc.setFontSize(14);
    doc.text(`ITOGOVAYA OCENKA: ${gameState.finalScore}/100`, 105, 115, { align: 'center' });
    
    // –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
    doc.setFontSize(12);
    doc.text('FINAL\'NYE POKAZATELI:', 20, 130);
    doc.setFontSize(10);
    doc.text(`VVP indeks: ${state.gdpIdx.toFixed(1)} (izmenenie: ${formatChange(gameState.changes.gdp)})`, 20, 140);
    doc.text(`Eksport indeks: ${state.expIdx.toFixed(1)} (izmenenie: ${formatChange(gameState.changes.exp)})`, 20, 150);
    doc.text(`Import indeks: ${state.impIdx.toFixed(1)} (izmenenie: ${formatChange(gameState.changes.imp)})`, 20, 160);
    doc.text(`Inflyaciya: ${state.cpi.toFixed(1)}% (izmenenie: ${formatChange(gameState.changes.cpi, '%')})`, 20, 170);
    doc.text(`Bezrabotica: ${state.unemployment.toFixed(1)}% (izmenenie: ${formatChange(gameState.changes.unemployment, '%')})`, 20, 180);
    doc.text(`Doverie: ${Math.round(gameState.trust)}`, 20, 190);
    
    // –†–∞–∑–±–∏–≤–∫–∞ –æ—Ü–µ–Ω–∫–∏
    doc.setFontSize(12);
    doc.text('STRUKTURA OCENKI:', 20, 205);
    doc.setFontSize(10);
    const breakdown = gameState.scoreBreakdown;
    doc.text(`Bazovye ochki: ${breakdown.baseScore}/60`, 20, 215);
    doc.text(`Bonus za slozhnost': ${breakdown.countryBonus}/15`, 20, 225);
    doc.text(`Kachestvo reshenij: ${breakdown.performanceBonus}/20`, 20, 235);
    doc.text(`Posledovatel'nost': ${breakdown.consistencyBonus}/5`, 20, 245);
    
    // –ö—Ä–∞—Ç–∫–∏–π –∞–Ω–∞–ª–∏–∑
    doc.setFontSize(12);
    doc.text('KRATKIJ ANALIZ:', 20, 260);
    doc.setFontSize(9);
    // –†–∞–∑–±–∏–≤–∞–µ–º –¥–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–∞ —Å—Ç—Ä–æ–∫–∏ (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–ª—è PDF)
    const analysis = `Obshchaya ocenka: ${getScoreDescription()}`;
    const lines = doc.splitTextToSize(analysis, 170);
    let yPos = 270;
    lines.slice(0, 4).forEach(line => { // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫
        doc.text(line, 20, yPos);
        yPos += 8;
    });
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ PDF
    doc.save(`Torgovye_vojny_${studentName.replace(/\s+/g, '_')}_${studentGroup}.pdf`);
}